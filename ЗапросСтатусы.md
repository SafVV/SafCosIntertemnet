```bsl
ВЫБРАТЬ
	РегистрСтатусов.Заказ КАК Заказ,
	РегистрСтатусов.Период КАК Период,
	РегистрСтатусов.Статус КАК Статус
ПОМЕСТИТЬ ВТ_ВсяИстория
ИЗ
	РегистрСведений.РегистрСтатусов КАК РегистрСтатусов
ГДЕ
	РегистрСтатусов.Заказ = &Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ВсяИстория.Заказ КАК Заказ,
	ВТ_ВсяИстория.Период КАК ПериодС, 
	МИНИМУМ(РегистрСтатусов.Период) КАК ПериодПо, 
	ВТ_ВсяИстория.Статус КАК Статус	
ИЗ
	ВТ_ВсяИстория КАК ВТ_ВсяИстория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РегистрСтатусов КАК РегистрСтатусов
		ПО (ВТ_ВсяИстория.Период < РегистрСтатусов.Период)
ГДЕ
	ВТ_ВсяИстория.Заказ = &Заказ

СГРУППИРОВАТЬ ПО
	ВТ_ВсяИстория.Заказ,
	ВТ_ВсяИстория.Период, 
	ВТ_ВсяИстория.Статус
////////////////////////////////////////////////////////////////////////////////

```
